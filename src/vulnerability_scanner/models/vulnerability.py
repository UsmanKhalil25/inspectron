from dataclasses import dataclass, asdict
from datetime import datetime
from typing import Optional

from ..enums import VulnerabilityType, Severity


@dataclass
class Vulnerability:
    type: VulnerabilityType
    severity: Severity
    title: str
    description: str
    url: str
    timestamp: Optional[datetime] = None

    def __post_init__(self):
        if self.timestamp is None:
            self.timestamp = datetime.now()

    def dict(self) -> dict:
        return asdict(self)
